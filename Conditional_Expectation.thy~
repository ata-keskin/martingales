theory Conditional_Expectation
  imports "HOL-Analysis.Radon_Nikodym"
begin



subsection \<open>Radon-Nikodym Property\<close>

(* The variation of a measure: *)
definition variation :: "'a measure \<Rightarrow> 'a set \<Rightarrow> ennreal" where
  "variation F A = (SUP \<pi> \<in> {\<pi> :: nat \<Rightarrow> 'a set. disjoint_family \<pi> \<and> finite (range \<pi>) \<and> \<Union> (range \<pi>) = A}. (\<Sum>x \<in> range \<pi>. emeasure F x))"  

lemma variation_positive_measure:
  "variation F A = (SUP x \<in> {x \<in> F. A \<subseteq> x}. emeasure F x)"
proof-

locale radon_nikodym_property =
  fixes M :: "'a measure" and f :: "'a \<Rightarrow> 'b :: {real_normed_vector}"
  assumes bounded_variation: "variation M (space M) < \<infinity>"
      and rnp: "\<And>N. \<lbrakk>finite_measure N; absolutely_continuous M N\<rbrakk> \<Longrightarrow> \<exists>f. integrable N f \<and> (\<forall>E\<in>M. measure M E = LINT x | N. f x * indicator E x)"